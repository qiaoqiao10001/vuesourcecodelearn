{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observe/index.js","../../src/state.js","../../src/compile/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function proxy(vm,source,key){\n  Object.defineProperty(vm,key,{\n    get(){\n      return vm[source][key]\n    },\n    set(newValue){\n      vm[source][key] = newValue;\n    }\n  })\n}\nexport function isObject(data){\n  return typeof data === 'object' && data !== null;\n}\n\nexport function def(data,key,value){\n  Object.defineProperty(data,key,{\n    enumerable:false,\n    configurable: false,\n    value\n  })\n}","import {isObject} from '../util/index'\n\nclass Observe{\n  constructor(value){\n    // 如果数据层次过多，需要递归解析属性，依次增加set和get方法；\n    // def\n    if(Array.isArray(value)){\n      value.__proto__ = arrayMethods;\n      // 数组里面有对象我再次监控\n      this.observerArray(value);\n    }else{\n      this.walk(value);  // 对对象进行观测\n    }\n  }\n  walk(data){\n    let keys = Object.keys(data); // [name,age,address] \n    keys.forEach(key => {\n      // 定义响应\n      defineReactive(data,key,data[key])\n    })\n  }\n}\n\nfunction defineReactive(data,key,value){\n  Object.defineProperty(data,key,{\n    configurable: true,\n    enumerable: false,\n    get(){\n      // 取值的时候操作\n      return value;\n    },\n    set(newValue){\n      console.log('更新数据')\n      if(newValue === value) return;\n      // 如果用户设置的值是一个对象，我也要进行劫持，给他设置响应\n      observe(value)\n      value = newValue;\n    }\n  })\n}\n\nexport function observe(data){\n  let isObj = isObject(data);\n  if(!isObj){\n    return\n  }\n  return new Observe(data)\n}","import {proxy} from './util/index'\nimport {observe} from './observe/index'\nexport function initState(vm){\n  const opts = vm.$options;\n  if(opts.props){\n    initProps(vm)\n  }\n  if(opts.methods){\n    initMethod(vm)\n  }\n  if(opts.data){\n    initData(vm)\n  }\n  if(opts.computed){\n    initComputed(vm)\n  }\n  if(opts.watch){\n    initWatch(vm)\n  }\n}\n\nfunction initData(vm){\n  let data = vm.$options.data; //用户传递的data\n  // console.log(data,'===')\n  // 用户选项data传递函数或者对象过来\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  // 判断数据类型，如果改变了数据，我要得到通知，去刷新页面；\n  // console.log(data)\n  for(let key in data){\n    proxy(vm,'_data',key)\n  }\n  observe(data); // 实现数据响应式\n}","// 解析html\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;  \nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\n\nfunction parseHTML(html){\n  // 使用while循环不断解析html标签成函数\n  while(html){\n    let textEnd = html.indexOf('<');\n    if(textEnd === 0){\n      // 匹配第一个尖括号<\n      const startTagMatch = parseStartTag();\n      if(startTagMatch){\n        // 遇到html标签就插件ast语法树\n        start(parseStartTag.tagName,parseStartTag.attrs)\n      }\n       \n    }\n  }\n\n  function start(tagName, attrs){\n\n  }\n\n  function parseStartTag(){\n    const start = html.match(startTagOpen);\n    if(start){\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n      // 匹配到一个之后就删除，继续从头开始匹配\n      advance(start[0].length)\n      let attr,end;\n      // 捕获属性\n      while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\n        advance(attr[0].length);\n        match.attrs.push({name: attr[1], value: attr[3]})\n      }\n      if(end){\n        advance(end[0].length);\n        return match\n      }\n    }\n  }\n  function advance(n){\n    // 截取未捕获的\n    html = html.substring(n)\n  }\n}\n\nexport function compileToFunction(template){\n  // 讲模板解析成函数\n  console.log(template)\n  parseHTML(template)\n  return function(){}\n}","import Vue from './index'\nimport {initState} from './state'\nimport {compileToFunction} from './compile/index'\nexport function initMixins(options){\n  // 初始化Vue\n  Vue.prototype._init = function(options){\n    const vm = this;\n    vm.$options = options;\n    // 初始化状态\n    initState(vm)\n    // 模板编译\n    if(vm.$options.el){\n      vm.$mount(vm.$options.el)\n    }\n  }\n}\nVue.prototype.$mount = function(el){\n  console.log(el)\n  const vm = this;\n  const options = vm.$options;\n  el = document.querySelector(el);\n  console.log(el)\n  // 如果用户没有传递render方法，就去使用template里面的东西\n  if(!options.render){\n    let template = options.template\n    // 如果没有模板但是有el\n    if(!template && el){\n      template = el.outerHTML;\n    }\n    const render = compileToFunction(template);\n    options.render = render\n  }\n}","import {initMixins} from './init'\nfunction Vue(options){\n  this._init(options);\n}\n\ninitMixins(Vue)\nexport default Vue;"],"names":["proxy","vm","source","key","Object","defineProperty","get","set","newValue","isObject","data","Observe","value","Array","isArray","__proto__","arrayMethods","observerArray","walk","keys","forEach","defineReactive","configurable","enumerable","console","log","observe","isObj","initState","opts","$options","props","initProps","methods","initMethod","initData","computed","initComputed","watch","initWatch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","attribute","startTagClose","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","start","match","tagName","attrs","advance","length","attr","end","push","name","n","substring","compileToFunction","template","initMixins","options","Vue","prototype","_init","el","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}